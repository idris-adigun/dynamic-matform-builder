<form
  *ngIf="schema && schema.fields"
  [formGroup]="form"
  (ngSubmit)="onSubmit()"
>
  <div *ngFor="let field of schema.fields" class="form-field">
    <ng-container [ngSwitch]="field.type">
      <!-- Text Input -->
      <mat-form-field
        *ngSwitchCase="'text'"
        [appearance]="formAppearance"
        [ngStyle]="getStyles(field.name)?.formField"
      >
        <mat-label>{{ field.label }}</mat-label>
        <input
          matInput
          [formControlName]="field.name"
          [placeholder]="field.placeholder"
          [ngStyle]="getStyles(field.name)?.input"
        />
      </mat-form-field>

      <!-- Email Input -->
      <mat-form-field *ngSwitchCase="'email'" [appearance]="formAppearance">
        <mat-label>{{ field.label }}</mat-label>
        <input
          matInput
          type="email"
          [formControlName]="field.name"
          [placeholder]="field.placeholder"
        />
      </mat-form-field>

      <!-- Date Picker -->
      <mat-form-field
        *ngSwitchCase="'datepicker'"
        [appearance]="formAppearance"
      >
        <mat-label>{{ field.label }}</mat-label>
        <input
          matInput
          [matDatepicker]="picker"
          [formControlName]="field.name"
        />
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>

      <!-- Radio -->
      <mat-radio-group
        *ngIf="field.type === 'radio'"
        [formControlName]="field.name"
        [ngStyle]="getStyles(field.name)?.radioGroup"
      >
        <mat-radio-button
          *ngFor="let option of field.options"
          [value]="option?.value"
          [ngStyle]="getStyles(field.name)?.radioButton"
        >
          {{ option.label }}
        </mat-radio-button>
      </mat-radio-group>

      <!-- Checkbox -->
      <mat-checkbox
        *ngSwitchCase="'checkbox'"
        [formControlName]="field.name"
        [ngStyle]="getStyles(field.name)?.checkbox"
      >
        {{ field.label }}
      </mat-checkbox>

      <!-- Select Dropdown -->
      <mat-form-field
        *ngSwitchCase="'select'"
        [appearance]="formAppearance"
        [ngStyle]="getStyles(field.name)?.formField"
      >
        <mat-label>{{ field.label }}</mat-label>
        <mat-select [formControlName]="field.name">
          <mat-option
            *ngFor="let option of field.options"
            [value]="option.value"
          >
            {{ option.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </ng-container>

    <!-- Slide Input -->
    <mat-form-field *ngSwitchCase="'slide'" [appearance]="formAppearance">
      <mat-label>{{ field.label }}</mat-label>
      <mat-slide-toggle [formControlName]="field.name">
        {{ field.label }}
      </mat-slide-toggle>
    </mat-form-field>

    <!-- File Input -->
    <mat-form-field *ngSwitchCase="'file'" [appearance]="formAppearance">
      <mat-label>{{ field.label }}</mat-label>
      <input
        matInput
        type="file"
        [formControlName]="field.name"
        (change)="onFileChange($event, field.name)"
        [placeholder]="field.placeholder"
      />
    </mat-form-field>

    <!-- Display Errors -->
    <mat-error
      *ngIf="form.get(field.name)?.invalid && form.get(field.name)?.touched"
      [ngStyle]="getStyles(field.name)?.error"
    >
      <small *ngIf="form.get(field.name)?.errors?.['required']">
        {{ field.label }} is required.
      </small>
      <small *ngIf="form.get(field.name)?.errors?.['email']">
        Please enter a valid email.
      </small>
    </mat-error>
  </div>

  <button
    mat-raised-button
    color="primary"
    type="submit"
    [disabled]="form.invalid"
    [ngStyle]="getStyles('submitButton')"
  >
    Submit
  </button>
</form>
